# High-spatial-resolution gross primary production estimation from Sentinel-2 reflectance using hybrid Gaussian processes modeling

*(under review)*

## Abstract
High-spatial-resolution gross primary production (GPP) estimation is critical for local carbon monitoring, especially in heterogeneous landscapes where global products lack spatial detail. We present a hybrid modeling framework that estimates GPP using Sentinel-2 (S2) reflectance and Bayesian Gaussian Process Regression (GPR), chosen for its robustness with limited data and its ability to quantify uncertainty. GPR models were trained using SCOPE (Soil Canopy Observation of Photosynthesis and Energy fluxes) Radiative Transfer Model (RTM) simulations and optimized via active learning (AL) across 10 plant functional types (PFTs). These lightweight, PFT-specific S2-GPR models were implemented in Google Earth Engine (GEE) to enable scalable, reproducible, and accessible GPP mapping.
S2-GPR models predictive performances were evaluated using data from 67 eddy covariance flux towers across Europe. Data from 2017–2020 were used for training and training database optimization, while 2021–2024 data served as independent validation. Strong predictive performance was achieved in wetlands (R = 0.84, NRMSE = 12.6%), savannas (R = 0.81, NRMSE = 12.2%), and deciduous broadleaf forests (R = 0.81, NRMSE = 14.3%). Moderate accuracy was observed for croplands, shrublands, grasslands, and mixed forests (R = 0.67–0.77), with lower accuracy in evergreen broadleaf (R = 0.07) and needleleaf forests (R = 0.33). Compared to MODIS GPP (MOD17A2H V6.1), the S2-GPR models showed consistently lower bias and comparable or improved accuracy in most PFTs, except evergreen forests. These findings underscore the value of integrating SCOPE modeling and AL-optimized GPR for accurate, local-scale GPP mapping using cloud-based S2 data, complementing coarse-resolution global products.

## Use
In order to run the code in for example Anaconda JupyterLab, you will need a Google Earth Engine account and create an ImageCollection asset. When running the main notebook, you will have to connect to your own GEE account. Make sure to copy your ImageCollection path into the script (including a closing / at the end). You can adjust the region and time frame of interest to your own liking. Once the maps are exported to your GEE assets, you can download them into your Google drive. The images include two bands: the first one has the GPP estimates and the seconds the model's epistemic uncertainty.

The models can also be run directly in GEE, although results only include estimates and no uncertainties, due to high computational costs. The models and example script can be accessed on: https://code.earthengine.google.com/?accept_repo=users/declerckem3/S2-SCOPE-GPP
